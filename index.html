<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Date Calculator</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<style>
  body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; }
  h2 { text-align: center; margin-bottom: 20px; }

  .calculator-box {
	background-color: #fff;
	padding: 20px;
	border-radius: 12px;
	box-shadow: 0 4px 12px rgba(0,0,0,0.1);
	max-width: 400px;
	margin: auto;
  }

  /* Mode container with extra spacing, no line */
  #modeContainer {
	padding-top: 12px;     /* more space above label */
	margin-bottom: 12px;   /* spacing below */
	border-bottom: none;   /* remove grey line */
  }

  /* Labels - original small font */
  .calculator-box label {
	font-size: 0.7rem;  /* restore original small size */
	display: block;
  }

  /* Inputs and selects - original font size and slight top margin */
  .calculator-box input,
  .calculator-box select {
	font-size: 0.9rem;
	padding: 4px 6px;
	margin-top: 6px;
	width: 100%;
	box-sizing: border-box;
  }

  /* Buttons - separate spacing */
  .calculator-box button {
	padding: 4px 10px;
	font-size: 0.9rem;
	margin-top: 12px;
  }

  button.calculate { width: 100%; font-size: 0.85rem; }
  button.copy-btn { border-radius: 8px; background-color: white; border: 1px solid #ccc; }

  /* Slight spacing between elements inside addMode / betweenMode */
  #addMode > * + *,
  #betweenMode > * + * {
	margin-top: 10px;
  }

  /* Output and summary */
  .output-container {
	display: none;
	margin-top: 12px;
	justify-content: flex-end;
	align-items: center;
  }
  #output { flex: 1; font-size: 0.9rem; margin-right: 10px; }
  #copiedText { font-size: 0.8rem; color: green; display: none; margin-right: 10px; white-space: nowrap; }

  #summary {
	font-size: 0.8rem;
	color: #555;
	margin: 12px 0;
	text-align: left;
  }

  /* Compact Flatpickr calendar */
  .flatpickr-calendar { font-size: 0.78rem; max-width: 95%; }
  .flatpickr-weekday { font-size: 0.68rem; padding: 2px 0; }
  .flatpickr-day { font-size: 0.78rem; padding: 7px 6px; margin: 1px; border-radius: 5px; }
  .flatpickr-month { font-size: 0.78rem; }
  .flatpickr-week { margin-bottom: 2px; }

  /* Inline checkbox labels */
  label.checkbox-inline {
	display: flex;
	align-items: center;
	gap: 6px;
	font-size: 0.8rem;      /* smaller font for checkboxes */
	color: #666;            /* grey text */
	margin-top: 10px;
  }
  label.checkbox-inline input[type="checkbox"] {
	width: auto;
	height: auto;
	margin: 0;
  }

  /* MOBILE FRIENDLY STYLING */
  @media (max-width: 480px) {
	input, select, button {
	  padding: 8px 10px;
	  font-size: 1rem;
	}
	label { margin-top: 14px; }

	.output-container {
	  flex-wrap: wrap;
	}
	#output {
	  flex: 1 1 100%;
	  margin-right: 0;
	  margin-bottom: 5px;
	}
	#copiedText {
	  order: 1;
	  margin: 0 5px 5px 0;
	}
	button.copy-btn {
	  order: 2;
	  flex: 0 0 auto;
	}
	button.calculate {
	  padding: 10px 15px;
	  font-size: 1rem;
	}

	#startDate, #date1, #date2, #duration, #unit, #monthType, #format {
	  width: calc(100% - 16px);
	  margin-right: 0;
	  padding-left: 8px;
	  padding-right: 8px;
	  box-sizing: border-box;
	}
  }
</style>
</head>
<body>

<h2>Date Calculator</h2>

<div class="calculator-box">

  <!-- Mode selection with extra spacing, no line -->
  <div id="modeContainer">
	<label for="mode">Select Calculation Mode:</label>
	<select id="mode" onchange="toggleMode()">
	  <option value="add" selected>Add Duration to Date</option>
	  <option value="between">Days Between Two Dates</option>
	</select>
  </div>

  <!-- Add duration mode -->
  <div id="addMode">
	<label for="startDate">Start Date:</label>
	<input type="text" id="startDate" placeholder="Select a date">

	<label for="duration">Duration:</label>
	<input type="number" id="duration" placeholder="Enter number" min="1">

	<select id="unit">
	  <option value="days" selected>Days</option>
	  <option value="weeks">Weeks</option>
	  <option value="months">Months</option>
	</select>

	<label class="checkbox-inline"><input type="checkbox" id="includeStart"> Include start day</label>

	<select id="monthType">
	  <option value="28">28-day month</option>
	  <option value="calendar">Calendar month</option>
	</select>

	<select id="format">
	  <option value="dayMon" selected>Day Mon</option>
	  <option value="ddmmyyyy">DD/MM/YYYY</option>
	  <option value="iso">ISO YYYY-MM-DD</option>
	</select>
  </div>

  <!-- Days between mode -->
  <div id="betweenMode" style="display: none;">
	<label for="date1">Start Date:</label>
	<input type="text" id="date1" placeholder="Select first date">

	<label for="date2">End Date:</label>
	<input type="text" id="date2" placeholder="Select second date">

	<label class="checkbox-inline"><input type="checkbox" id="includeEnd"> Include end date</label>
  </div>

  <div class="output-container" id="outputContainer">
	<input type="text" id="output" readonly>
	<span id="copiedText">Copied</span>
	<button class="copy-btn" onclick="copyOutput()">Copy</button>
  </div>

  <div id="summary"></div>

  <button class="calculate" onclick="calculate()">Calculate</button>

</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
flatpickr("#startDate", { dateFormat: "Y-m-d" });
flatpickr("#date1", { dateFormat: "Y-m-d" });
flatpickr("#date2", { dateFormat: "Y-m-d" });

function toggleMode() {
  const mode = document.getElementById('mode').value;
  document.getElementById('addMode').style.display = mode === 'add' ? 'block' : 'none';
  document.getElementById('betweenMode').style.display = mode === 'between' ? 'block' : 'none';
  document.getElementById('outputContainer').style.display = 'none';
  document.getElementById('summary').textContent = '';
}

function formatDate(date, format) {
  const day = ("0" + date.getDate()).slice(-2);
  const month = ("0" + (date.getMonth() + 1)).slice(-2);
  const year = date.getFullYear();
  const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
  if (format === 'dayMon') return day + ' ' + monthNames[date.getMonth()];
  if (format === 'ddmmyyyy') return `${day}/${month}/${year}`;
  if (format === 'iso') return `${year}-${month}-${day}`;
  return '';
}

function calculate() {
  const mode = document.getElementById('mode').value;
  let result = "";
  let summary = "";

  if (mode === 'add') {
	const start = new Date(document.getElementById('startDate').value);
	const duration = parseInt(document.getElementById('duration').value);
	const includeStart = document.getElementById('includeStart').checked;
	const unit = document.getElementById('unit').value;
	const monthType = document.getElementById('monthType').value;
	const format = document.getElementById('format').value;

	if (isNaN(start) || isNaN(duration) || duration < 1) {
	  alert('Please select a valid start date and duration.');
	  return;
	}

	let end = new Date(start);
	if (unit === 'days') end.setDate(end.getDate() + duration - (includeStart ? 1 : 0));
	else if (unit === 'weeks') end.setDate(end.getDate() + duration * 7 - (includeStart ? 1 : 0));
	else if (unit === 'months') {
	  if (monthType === '28') end.setDate(end.getDate() + duration * 28 - (includeStart ? 1 : 0));
	  else {
		end.setMonth(end.getMonth() + duration);
		if (!includeStart) end.setDate(end.getDate() - 1);
	  }
	}

	result = formatDate(end, format);
	summary = `Start: ${formatDate(start, format)} | Duration: ${duration} ${unit} | End: ${result}`;

  } else if (mode === 'between') {
	const d1 = new Date(document.getElementById('date1').value);
	const d2 = new Date(document.getElementById('date2').value);
	const includeEnd = document.getElementById('includeEnd').checked;

	if (isNaN(d1) || isNaN(d2)) {
	  alert('Please select both dates.');
	  return;
	}

	const diffTime = Math.abs(d2 - d1);
	let diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
	if (includeEnd) diffDays += 1;

	const weeks = Math.floor(diffDays / 7);
	const daysRemainder = diffDays % 7;
	let breakdown = "";
	if (weeks > 0) {
	  breakdown += `${weeks} week${weeks > 1 ? "s" : ""}`;
	  if (daysRemainder > 0) breakdown += ` + ${daysRemainder} day${daysRemainder > 1 ? "s" : ""}`;
	} else if (daysRemainder > 0) breakdown += `${daysRemainder} day${daysRemainder > 1 ? "s" : ""}`;

	result = diffDays + " day" + (diffDays > 1 ? "s" : "");
	if (breakdown) result += ` (${breakdown})`;
	summary = `Between ${d1.toDateString()} and ${d2.toDateString()} = ${result}`;
  }

  document.getElementById('output').value = result;
  document.getElementById('outputContainer').style.display = 'flex';
  document.getElementById('summary').textContent = summary;
}

function copyOutput() {
  const output = document.getElementById('output');
  output.select();
  document.execCommand("copy");
  const copiedText = document.getElementById('copiedText');
  copiedText.style.display = 'inline';
  setTimeout(() => copiedText.style.display = 'none', 1500);
}
</script>

</body>
</html>
